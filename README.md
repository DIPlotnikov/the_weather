# Weather Service

Сервис для получения информации о погоде в различных городах мира.

## Описание

Проект представляет собой Django-приложение, которое предоставляет API для получения информации о погоде. Сервис использует внешние API (OpenWeatherMap и WorldTime) для получения актуальных данных о погоде и времени. Для оптимизации производительности и уменьшения нагрузки на внешние API, данные о погоде кэшируются в Redis с временем жизни 10 минут.

## Структура проекта

```
weather/
├── api/                    # Основное приложение API
│   ├── models.py          # Модели данных
│   ├── serializers.py     # Сериализаторы для API
│   ├── views.py           # Представления API
│   ├── urls.py            # Маршрутизация API
│   └── handlers.py        # Обработчики бизнес-логики
├── external_api/          # Интеграция с внешними API
│   ├── openweathermap_client.py  # Клиент OpenWeatherMap
│   ├── worldtime_client.py       # Клиент WorldTime
│   └── decorators.py     # Декораторы для работы с API
└── weather/              # Основные настройки проекта
```

## Технологии

- Python 3.10
- Django
- Django REST Framework
- OpenWeatherMap API
- WorldTime API
- Redis для кэширования
- pytest для тестирования

## API Endpoints

### 1. Получение текущей погоды
```
GET /api/weather/current?city={city_name}
```
Возвращает текущую температуру и локальное время в указанном городе.

**Query-параметры:**
- `city` (обязательный) — название города на английском языке (например: `Moscow`, `Amsterdam`)

**Пример ответа:**
```json
{
    "temperature": 22.1,        // Текущая температура в градусах Цельсия
    "local_time": "16:45"      // Локальное время в формате HH:mm
}
```

### 2. Получение прогноза погоды
```
GET /api/weather/forecast?city={city_name}&date={date}
```
Возвращает прогноз температуры на заданную дату: минимальное и максимальное значение.

**Query-параметры:**
- `city` (обязательный) — название города на английском языке
- `date` (обязательный) — дата в формате `"dd.MM.yyyy"` (например: `"30.06.2025"`)

**Ограничения по дате:**
- Дата не может быть в прошлом
- Дата не может быть в будущем больше, чем на 10 дней от текущей

**Пример ответа:**
```json
{
    "min_temperature": 11.1,
    "max_temperature": 24.5
}
```

### 3. Установка прогноза погоды
```
POST /api/weather/forecast
```
Позволяет вручную задать или переопределить прогноз погоды для указанного города на текущую или будущую дату.

**Тело запроса:**
```json
{
    "city": "Berlin",
    "date": "11.06.2025",
    "min_temperature": 10.0,
    "max_temperature": 18.5
}
```

**Описание полей:**
- `city` (строка, обязательное) — название города на английском языке
- `date` (строка, обязательное) — дата в формате `"dd.MM.yyyy"`
- `min_temperature` (число, обязательное) — минимальная температура в градусах Цельсия
- `max_temperature` (число, обязательное) — максимальная температура в градусах Цельсия

**Ограничения:**
- Дата не может быть в прошлом
- Дата не может быть в будущем больше, чем через 10 дней
- `min_temperature` не может быть больше `max_temperature`

## Кэширование

Сервис использует Redis для кэширования данных о погоде:
- Время жизни кэша: 10 минут
- Ключи кэша формируются на основе названия города и префикса, указывающего на метод
- При истечении времени жизни кэша данные автоматически обновляются при следующем запросе
- Кэширование позволяет значительно снизить нагрузку на внешние API и ускорить ответы сервиса

## Тестирование

Для запуска тестов используйте:
```bash
pytest
```

